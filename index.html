<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ­£æ‹³ä¸­æ®µçªããƒãƒ£ãƒ¬ãƒ³ã‚¸</title>

<style>
body {
  text-align:center;
  font-family:sans-serif;
  background:#f5f5f5;
}

h1 {
  margin-top:40px;
  font-size:26px;
  letter-spacing:2px;
}

#dojobar {
  width:100%;
  height:6px;
  background:red;
  margin-top:10px;
}

#btn {
  width:200px;
  height:200px;
  background:black;
  color:white;
  border-radius:50%;
  font-size:22px;
  margin:60px auto;
  line-height:200px;
  box-shadow:0 10px 25px rgba(0,0,0,0.4);
}

#btn:active {
  transform:scale(0.9);
  background:red;
}

#score,#combo {
  font-size:20px;
  margin-top:10px;
}

button {
  font-size:18px;
  padding:10px 20px;
  margin-top:20px;
}
</style>
</head>

<body>

<h1>æ­£æ‹³ä¸­æ®µçªã<br>ãƒªã‚ºãƒ ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h1>
<div id="dojobar"></div>

<div id="btn">æŠ¼å¿ï¼</div>

<p id="score">ã‚¹ã‚³ã‚¢: 0</p>
<p id="combo">ã‚³ãƒ³ãƒœ: 0</p>

<button onclick="sendScore()">ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç™»éŒ²</button>

<footer style="margin-top:40px;font-size:12px;color:gray;">
æ—¥æœ¬ç©ºæ‰‹é“ ä¸å‹•ä¼š
</footer>

<audio id="hitSound" src="https://www.soundjay.com/mechanical/sounds/swish-1.mp3" preload="auto"></audio>
<audio id="osSound" src="https://www.soundjay.com/human/sounds/applause-8.mp3" preload="auto"></audio>

<script>
let score=0;
let combo=0;
let maxCombo=0;
let lastTap=0;

const btn=document.getElementById("btn");
const scoreText=document.getElementById("score");
const comboText=document.getElementById("combo");

const hitSound=document.getElementById("hitSound");
const osSound=document.getElementById("osSound");

// ğŸ”Š ã‚¹ãƒãƒ›éŸ³è§£æ”¾
document.body.addEventListener("touchstart",()=>{
 hitSound.play().then(()=>hitSound.pause());
},{once:true});

// çªãå‡¦ç†
btn.addEventListener("click",()=>{

 hitSound.currentTime=0;
 hitSound.play();

 const now=Date.now();

 if(now-lastTap<500){
   combo++;
   score+=10*combo;
   if(combo>maxCombo) maxCombo=combo;
 } else {
   combo=1;
 }

 if(combo===10){
   osSound.currentTime=0;
   osSound.play();
 }

 lastTap=now;

 scoreText.textContent="ã‚¹ã‚³ã‚¢: "+score;
 comboText.textContent="ã‚³ãƒ³ãƒœ: "+combo+" (MAX "+maxCombo+")";
});


// â­ ãƒ©ãƒ³ã‚­ãƒ³ã‚°é€ä¿¡
function sendScore(){

 const name=prompt("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
 if(!name) return;

 fetch("https://script.google.com/macros/s/AKfycbw3iOC_7EBRqfXUZjnblOXdTI8gcLcpA8RqEf_lurK9YQhcO5AduBAMJBLo71qfbHET/exec",{
   method:"POST",
   body:JSON.stringify({
     name:name,
     score:score
   })
 })
 .then(()=>alert("ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç™»éŒ²ã—ã¾ã—ãŸï¼"))
 .catch(()=>alert("é€ä¿¡å¤±æ•—"));
}
</script>

</body>
</html>
